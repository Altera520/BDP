---
- name: check file exists
  local_action: stat path="{{ act }}-kafka.yml"
  register: file

- name: check installed status
  stat: 
    path: "{{ stack_root }}/{{ kafka_download_filename }}"
  register: installed

- include_tasks: "{{ act }}-kafka.yml"
  when: file.stat.exists and
        (act == "setup" and not installed.stat.exists) or
        act != "setup"