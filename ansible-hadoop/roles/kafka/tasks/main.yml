---
- name: check file exists
  local_action: stat path="{{ role_path }}/tasks/{{ act }}-kafka.yml"
  register: file

- name: check installed status
  stat: 
    path: "{{ stack_root }}/{{ kafka_download_filename }}"
  register: installed

- include_tasks: "{{ act }}-kafka.yml"
  when: 
    - file.stat.exists
    - (act == "setup" and not installed.stat.exists) or act != "setup"